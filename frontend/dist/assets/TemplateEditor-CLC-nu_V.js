import{c as fe,r as c,W as re,j as t,F as tt,z as Oe}from"./index-C5px4MfY.js";import{X as xe,F as Se,S as rt}from"./x-By0me3VG.js";import{C as nt}from"./check-circle-1ppiQmE5.js";import{S as at}from"./save-CkZK4anR.js";import{U as st,P as ne,T as it}from"./user-CU97xRpH.js";import{A as ot}from"./alert-triangle-BGl7UauM.js";import{T as ge}from"./trash-2-C28K0-Y6.js";import{Z as ct}from"./zap-DnLljTK6.js";import{G as lt}from"./globe-Cse-dic-.js";import{C as ut,a as dt}from"./chevron-right-kSdhYXZR.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ft=fe("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ht=fe("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=fe("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mt=fe("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);function Ee(e,r){(r==null||r>e.length)&&(r=e.length);for(var a=0,s=Array(r);a<r;a++)s[a]=e[a];return s}function pt(e){if(Array.isArray(e))return e}function xt(e,r,a){return(r=Nt(r))in e?Object.defineProperty(e,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[r]=a,e}function gt(e,r){var a=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(a!=null){var s,o,u,m,g=[],w=!0,N=!1;try{if(u=(a=a.call(e)).next,r!==0)for(;!(w=(s=u.call(a)).done)&&(g.push(s.value),g.length!==r);w=!0);}catch(D){N=!0,o=D}finally{try{if(!w&&a.return!=null&&(m=a.return(),Object(m)!==m))return}finally{if(N)throw o}}return g}}function vt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Te(e,r){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),a.push.apply(a,s)}return a}function Re(e){for(var r=1;r<arguments.length;r++){var a=arguments[r]!=null?arguments[r]:{};r%2?Te(Object(a),!0).forEach(function(s){xt(e,s,a[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Te(Object(a)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(a,s))})}return e}function bt(e,r){if(e==null)return{};var a,s,o=jt(e,r);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(s=0;s<u.length;s++)a=u[s],r.indexOf(a)===-1&&{}.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}function jt(e,r){if(e==null)return{};var a={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(r.indexOf(s)!==-1)continue;a[s]=e[s]}return a}function yt(e,r){return pt(e)||gt(e,r)||kt(e,r)||vt()}function wt(e,r){if(typeof e!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var s=a.call(e,r);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function Nt(e){var r=wt(e,"string");return typeof r=="symbol"?r:r+""}function kt(e,r){if(e){if(typeof e=="string")return Ee(e,r);var a={}.toString.call(e).slice(8,-1);return a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set"?Array.from(e):a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?Ee(e,r):void 0}}function Ct(e,r,a){return r in e?Object.defineProperty(e,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[r]=a,e}function $e(e,r){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),a.push.apply(a,s)}return a}function Ae(e){for(var r=1;r<arguments.length;r++){var a=arguments[r]!=null?arguments[r]:{};r%2?$e(Object(a),!0).forEach(function(s){Ct(e,s,a[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):$e(Object(a)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(a,s))})}return e}function Mt(){for(var e=arguments.length,r=new Array(e),a=0;a<e;a++)r[a]=arguments[a];return function(s){return r.reduceRight(function(o,u){return u(o)},s)}}function ae(e){return function r(){for(var a=this,s=arguments.length,o=new Array(s),u=0;u<s;u++)o[u]=arguments[u];return o.length>=e.length?e.apply(this,o):function(){for(var m=arguments.length,g=new Array(m),w=0;w<m;w++)g[w]=arguments[w];return r.apply(a,[].concat(o,g))}}}function de(e){return{}.toString.call(e).includes("Object")}function Ot(e){return!Object.keys(e).length}function ie(e){return typeof e=="function"}function St(e,r){return Object.prototype.hasOwnProperty.call(e,r)}function Pt(e,r){return de(r)||Y("changeType"),Object.keys(r).some(function(a){return!St(e,a)})&&Y("changeField"),r}function Et(e){ie(e)||Y("selectorType")}function Tt(e){ie(e)||de(e)||Y("handlerType"),de(e)&&Object.values(e).some(function(r){return!ie(r)})&&Y("handlersType")}function Rt(e){e||Y("initialIsRequired"),de(e)||Y("initialType"),Ot(e)&&Y("initialContent")}function $t(e,r){throw new Error(e[r]||e.default)}var At={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"},Y=ae($t)(At),le={changes:Pt,selector:Et,handler:Tt,initial:Rt};function Lt(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};le.initial(e),le.handler(r);var a={current:e},s=ae(Ht)(a,r),o=ae(It)(a),u=ae(le.changes)(e),m=ae(Dt)(a);function g(){var N=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(D){return D};return le.selector(N),N(a.current)}function w(N){Mt(s,o,u,m)(N)}return[g,w]}function Dt(e,r){return ie(r)?r(e.current):r}function It(e,r){return e.current=Ae(Ae({},e.current),r),r}function Ht(e,r,a){return ie(r)?r(e.current):Object.keys(a).forEach(function(s){var o;return(o=r[s])===null||o===void 0?void 0:o.call(r,e.current[s])}),a}var Ut={create:Lt},Vt={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.55.1/min/vs"}};function qt(e){return function r(){for(var a=this,s=arguments.length,o=new Array(s),u=0;u<s;u++)o[u]=arguments[u];return o.length>=e.length?e.apply(this,o):function(){for(var m=arguments.length,g=new Array(m),w=0;w<m;w++)g[w]=arguments[w];return r.apply(a,[].concat(o,g))}}}function zt(e){return{}.toString.call(e).includes("Object")}function Ft(e){return e||Le("configIsRequired"),zt(e)||Le("configType"),e.urls?(Bt(),{paths:{vs:e.urls.monacoBase}}):e}function Bt(){console.warn(De.deprecation)}function Yt(e,r){throw new Error(e[r]||e.default)}var De={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
    use
      monaco.config({ paths: { vs: '...' } })

    For more please check the link https://github.com/suren-atoyan/monaco-loader#config
  `},Le=qt(Yt)(De),Gt={config:Ft},Wt=function(){for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return function(o){return a.reduceRight(function(u,m){return m(u)},o)}};function Ie(e,r){return Object.keys(r).forEach(function(a){r[a]instanceof Object&&e[a]&&Object.assign(r[a],Ie(e[a],r[a]))}),Re(Re({},e),r)}var _t={type:"cancelation",msg:"operation is manually canceled"};function ve(e){var r=!1,a=new Promise(function(s,o){e.then(function(u){return r?o(_t):s(u)}),e.catch(o)});return a.cancel=function(){return r=!0},a}var Kt=["monaco"],Zt=Ut.create({config:Vt,isInitialized:!1,resolve:null,reject:null,monaco:null}),He=yt(Zt,2),oe=He[0],he=He[1];function Jt(e){var r=Gt.config(e),a=r.monaco,s=bt(r,Kt);he(function(o){return{config:Ie(o.config,s),monaco:a}})}function Xt(){var e=oe(function(r){var a=r.monaco,s=r.isInitialized,o=r.resolve;return{monaco:a,isInitialized:s,resolve:o}});if(!e.isInitialized){if(he({isInitialized:!0}),e.monaco)return e.resolve(e.monaco),ve(be);if(window.monaco&&window.monaco.editor)return Ue(window.monaco),e.resolve(window.monaco),ve(be);Wt(Qt,tr)(rr)}return ve(be)}function Qt(e){return document.body.appendChild(e)}function er(e){var r=document.createElement("script");return e&&(r.src=e),r}function tr(e){var r=oe(function(s){var o=s.config,u=s.reject;return{config:o,reject:u}}),a=er("".concat(r.config.paths.vs,"/loader.js"));return a.onload=function(){return e()},a.onerror=r.reject,a}function rr(){var e=oe(function(a){var s=a.config,o=a.resolve,u=a.reject;return{config:s,resolve:o,reject:u}}),r=window.require;r.config(e.config),r(["vs/editor/editor.main"],function(a){var s=a.m||a;Ue(s),e.resolve(s)},function(a){e.reject(a)})}function Ue(e){oe().monaco||he({monaco:e})}function nr(){return oe(function(e){var r=e.monaco;return r})}var be=new Promise(function(e,r){return he({resolve:e,reject:r})}),Ve={config:Jt,init:Xt,__getMonacoInstance:nr},ar={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},je=ar,sr={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},ir=sr;function or({children:e}){return re.createElement("div",{style:ir.container},e)}var cr=or,lr=cr;function ur({width:e,height:r,isEditorReady:a,loading:s,_ref:o,className:u,wrapperProps:m}){return re.createElement("section",{style:{...je.wrapper,width:e,height:r},...m},!a&&re.createElement(lr,null,s),re.createElement("div",{ref:o,style:{...je.fullWidth,...!a&&je.hide},className:u}))}var dr=ur,qe=c.memo(dr);function fr(e){c.useEffect(e,[])}var ze=fr;function hr(e,r,a=!0){let s=c.useRef(!0);c.useEffect(s.current||!a?()=>{s.current=!1}:e,r)}var $=hr;function se(){}function te(e,r,a,s){return mr(e,s)||pr(e,r,a,s)}function mr(e,r){return e.editor.getModel(Fe(e,r))}function pr(e,r,a,s){return e.editor.createModel(r,a,s?Fe(e,s):void 0)}function Fe(e,r){return e.Uri.parse(r)}function xr({original:e,modified:r,language:a,originalLanguage:s,modifiedLanguage:o,originalModelPath:u,modifiedModelPath:m,keepCurrentOriginalModel:g=!1,keepCurrentModifiedModel:w=!1,theme:N="light",loading:D="Loading...",options:R={},height:J="100%",width:G="100%",className:X,wrapperProps:W={},beforeMount:Q=se,onMount:ee=se}){let[S,A]=c.useState(!1),[I,v]=c.useState(!0),C=c.useRef(null),j=c.useRef(null),q=c.useRef(null),k=c.useRef(ee),h=c.useRef(Q),y=c.useRef(!1);ze(()=>{let d=Ve.init();return d.then(p=>(j.current=p)&&v(!1)).catch(p=>(p==null?void 0:p.type)!=="cancelation"&&console.error("Monaco initialization: error:",p)),()=>C.current?L():d.cancel()}),$(()=>{if(C.current&&j.current){let d=C.current.getOriginalEditor(),p=te(j.current,e||"",s||a||"text",u||"");p!==d.getModel()&&d.setModel(p)}},[u],S),$(()=>{if(C.current&&j.current){let d=C.current.getModifiedEditor(),p=te(j.current,r||"",o||a||"text",m||"");p!==d.getModel()&&d.setModel(p)}},[m],S),$(()=>{let d=C.current.getModifiedEditor();d.getOption(j.current.editor.EditorOption.readOnly)?d.setValue(r||""):r!==d.getValue()&&(d.executeEdits("",[{range:d.getModel().getFullModelRange(),text:r||"",forceMoveMarkers:!0}]),d.pushUndoStop())},[r],S),$(()=>{var d,p;(p=(d=C.current)==null?void 0:d.getModel())==null||p.original.setValue(e||"")},[e],S),$(()=>{let{original:d,modified:p}=C.current.getModel();j.current.editor.setModelLanguage(d,s||a||"text"),j.current.editor.setModelLanguage(p,o||a||"text")},[a,s,o],S),$(()=>{var d;(d=j.current)==null||d.editor.setTheme(N)},[N],S),$(()=>{var d;(d=C.current)==null||d.updateOptions(R)},[R],S);let T=c.useCallback(()=>{var M;if(!j.current)return;h.current(j.current);let d=te(j.current,e||"",s||a||"text",u||""),p=te(j.current,r||"",o||a||"text",m||"");(M=C.current)==null||M.setModel({original:d,modified:p})},[a,r,o,e,s,u,m]),P=c.useCallback(()=>{var d;!y.current&&q.current&&(C.current=j.current.editor.createDiffEditor(q.current,{automaticLayout:!0,...R}),T(),(d=j.current)==null||d.editor.setTheme(N),A(!0),y.current=!0)},[R,N,T]);c.useEffect(()=>{S&&k.current(C.current,j.current)},[S]),c.useEffect(()=>{!I&&!S&&P()},[I,S,P]);function L(){var p,M,z,U;let d=(p=C.current)==null?void 0:p.getModel();g||((M=d==null?void 0:d.original)==null||M.dispose()),w||((z=d==null?void 0:d.modified)==null||z.dispose()),(U=C.current)==null||U.dispose()}return re.createElement(qe,{width:G,height:J,isEditorReady:S,loading:D,_ref:q,className:X,wrapperProps:W})}var gr=xr;c.memo(gr);function vr(e){let r=c.useRef();return c.useEffect(()=>{r.current=e},[e]),r.current}var br=vr,ue=new Map;function jr({defaultValue:e,defaultLanguage:r,defaultPath:a,value:s,language:o,path:u,theme:m="light",line:g,loading:w="Loading...",options:N={},overrideServices:D={},saveViewState:R=!0,keepCurrentModel:J=!1,width:G="100%",height:X="100%",className:W,wrapperProps:Q={},beforeMount:ee=se,onMount:S=se,onChange:A,onValidate:I=se}){let[v,C]=c.useState(!1),[j,q]=c.useState(!0),k=c.useRef(null),h=c.useRef(null),y=c.useRef(null),T=c.useRef(S),P=c.useRef(ee),L=c.useRef(),d=c.useRef(s),p=br(u),M=c.useRef(!1),z=c.useRef(!1);ze(()=>{let f=Ve.init();return f.then(x=>(k.current=x)&&q(!1)).catch(x=>(x==null?void 0:x.type)!=="cancelation"&&console.error("Monaco initialization: error:",x)),()=>h.current?ce():f.cancel()}),$(()=>{var x,E,F,B;let f=te(k.current,e||s||"",r||o||"",u||a||"");f!==((x=h.current)==null?void 0:x.getModel())&&(R&&ue.set(p,(E=h.current)==null?void 0:E.saveViewState()),(F=h.current)==null||F.setModel(f),R&&((B=h.current)==null||B.restoreViewState(ue.get(u))))},[u],v),$(()=>{var f;(f=h.current)==null||f.updateOptions(N)},[N],v),$(()=>{!h.current||s===void 0||(h.current.getOption(k.current.editor.EditorOption.readOnly)?h.current.setValue(s):s!==h.current.getValue()&&(z.current=!0,h.current.executeEdits("",[{range:h.current.getModel().getFullModelRange(),text:s,forceMoveMarkers:!0}]),h.current.pushUndoStop(),z.current=!1))},[s],v),$(()=>{var x,E;let f=(x=h.current)==null?void 0:x.getModel();f&&o&&((E=k.current)==null||E.editor.setModelLanguage(f,o))},[o],v),$(()=>{var f;g!==void 0&&((f=h.current)==null||f.revealLine(g))},[g],v),$(()=>{var f;(f=k.current)==null||f.editor.setTheme(m)},[m],v);let U=c.useCallback(()=>{var f;if(!(!y.current||!k.current)&&!M.current){P.current(k.current);let x=u||a,E=te(k.current,s||e||"",r||o||"",x||"");h.current=(f=k.current)==null?void 0:f.editor.create(y.current,{model:E,automaticLayout:!0,...N},D),R&&h.current.restoreViewState(ue.get(x)),k.current.editor.setTheme(m),g!==void 0&&h.current.revealLine(g),C(!0),M.current=!0}},[e,r,a,s,o,u,N,D,R,m,g]);c.useEffect(()=>{v&&T.current(h.current,k.current)},[v]),c.useEffect(()=>{!j&&!v&&U()},[j,v,U]),d.current=s,c.useEffect(()=>{var f,x;v&&A&&((f=L.current)==null||f.dispose(),L.current=(x=h.current)==null?void 0:x.onDidChangeModelContent(E=>{z.current||A(h.current.getValue(),E)}))},[v,A]),c.useEffect(()=>{if(v){let f=k.current.editor.onDidChangeMarkers(x=>{var F;let E=(F=h.current.getModel())==null?void 0:F.uri;if(E&&x.find(B=>B.path===E.path)){let B=k.current.editor.getModelMarkers({resource:E});I==null||I(B)}});return()=>{f==null||f.dispose()}}return()=>{}},[v,I]);function ce(){var f,x;(f=L.current)==null||f.dispose(),J?R&&ue.set(u,h.current.saveViewState()):(x=h.current.getModel())==null||x.dispose(),h.current.dispose()}return re.createElement(qe,{width:G,height:X,isEditorReady:v,loading:w,_ref:y,className:W,wrapperProps:Q})}var yr=jr,wr=c.memo(yr),Nr=wr;const kr=[{value:"critical",label:"Critical",color:"text-red-400 bg-red-500/20"},{value:"high",label:"High",color:"text-orange-400 bg-orange-500/20"},{value:"medium",label:"Medium",color:"text-yellow-400 bg-yellow-500/20"},{value:"low",label:"Low",color:"text-blue-400 bg-blue-500/20"},{value:"info",label:"Info",color:"text-cyan-400 bg-cyan-500/20"}],Cr=["GET","POST","PUT","DELETE","PATCH","HEAD","OPTIONS"],Mr=["status","word","regex","binary","dsl"],Or=["body","header","all","status_code"],Sr=`id: custom-poc-template

info:
  name: Custom POC Template
  author: your-name
  severity: info
  description: Description of the vulnerability
  tags: custom,poc

http:
  - method: GET
    path:
      - "{{BaseURL}}/"
    matchers:
      - type: status
        status:
          - 200
`;function Ur({template:e,onClose:r,onSave:a}){const[s,o]=c.useState("visual"),[u,m]=c.useState((e==null?void 0:e.content)||Sr),[g,w]=c.useState((e==null?void 0:e.id)||"custom-poc-"+Date.now()),[N,D]=c.useState((e==null?void 0:e.name)||""),[R,J]=c.useState((e==null?void 0:e.author)||""),[G,X]=c.useState((e==null?void 0:e.severity)||"info"),[W,Q]=c.useState((e==null?void 0:e.description)||""),[ee,S]=c.useState((e==null?void 0:e.category)||"custom"),[A,I]=c.useState((e==null?void 0:e.tags)||[]),[v,C]=c.useState((e==null?void 0:e.reference)||[]),[j,q]=c.useState(""),[k,h]=c.useState(""),[y,T]=c.useState({method:"GET",path:"{{BaseURL}}/",headers:[],body:"",rawRequest:"",useRaw:!1}),[P,L]=c.useState([{type:"status",condition:"or",values:["200"],part:"status_code",negative:!1}]),[d,p]=c.useState("or"),[M,z]=c.useState({basic:!0,severity:!0,description:!1,tags:!1,references:!1,http:!0,matchers:!0}),[U,ce]=c.useState(!0),[f,x]=c.useState(""),[E,F]=c.useState(!1);c.useEffect(()=>{e!=null&&e.content&&Be(e.content)},[]);const B=n=>{z(i=>({...i,[n]:!i[n]}))},Be=n=>{try{const i=n.match(/^id:\s*(.+)$/m),l=n.match(/name:\s*(.+)$/m),b=n.match(/author:\s*(.+)$/m),O=n.match(/severity:\s*(.+)$/m),H=n.match(/description:\s*(.+)$/m),K=n.match(/tags:\s*(.+)$/m);i&&w(i[1].trim()),l&&D(l[1].trim()),b&&J(b[1].trim()),O&&X(O[1].trim().toLowerCase()),H&&Q(H[1].trim()),K&&I(K[1].split(",").map(Z=>Z.trim()).filter(Z=>Z));const V=n.match(/method:\s*(.+)$/m),pe=n.match(/path:\s*\n\s*-\s*"?(.+?)"?\s*$/m);(V||pe)&&T(Z=>({...Z,method:V?V[1].trim():"GET",path:pe?pe[1].trim():"{{BaseURL}}/"}));const Me=n.match(/raw:\s*\n\s*-\s*\|[\s\S]*?\n([\s\S]*?)(?=\n\s*\w+:|$)/m);Me&&T(Z=>({...Z,useRaw:!0,rawRequest:Me[1].trim()}))}catch(i){console.error("解析 YAML 失败:",i)}},ye=()=>{let n=`id: ${g}

info:
  name: ${N||"Untitled POC"}
  author: ${R||"anonymous"}
  severity: ${G}
  description: ${W||"No description provided"}
  tags: ${A.join(",")}
`;return v.length>0&&(n+=`  reference:
`,v.forEach(i=>{n+=`    - ${i}
`})),n+=`
http:
`,y.useRaw&&y.rawRequest?(n+=`  - raw:
`,n+=`      - |
`,y.rawRequest.split(`
`).forEach(i=>{n+=`        ${i}
`})):(n+=`  - method: ${y.method}
`,n+=`    path:
`,n+=`      - "${y.path}"
`,y.headers.length>0&&(n+=`    headers:
`,y.headers.forEach(i=>{i.key&&i.value&&(n+=`      ${i.key}: ${i.value}
`)})),y.body&&(n+=`    body: |
`,y.body.split(`
`).forEach(i=>{n+=`      ${i}
`}))),P.length>0&&(P.length>1&&(n+=`
    matchers-condition: ${d}
`),n+=`    matchers:
`,P.forEach(i=>{n+=`      - type: ${i.type}
`,i.negative&&(n+=`        negative: true
`),i.type==="status"?(n+=`        status:
`,i.values.forEach(l=>{n+=`          - ${l}
`})):i.type==="word"?(n+=`        part: ${i.part}
`,n+=`        words:
`,i.values.forEach(l=>{n+=`          - "${l}"
`})):i.type==="regex"?(n+=`        part: ${i.part}
`,n+=`        regex:
`,i.values.forEach(l=>{n+=`          - "${l}"
`})):i.type==="dsl"&&(n+=`        dsl:
`,i.values.forEach(l=>{n+=`          - "${l}"
`}))})),n},we=async n=>{var i,l,b;try{(b=(l=(i=window.go)==null?void 0:i.main)==null?void 0:l.App)!=null&&b.ValidatePOCYAML&&(await window.go.main.App.ValidatePOCYAML(n),ce(!0),x("YAML 格式有效"))}catch(O){ce(!1),x((O==null?void 0:O.message)||"YAML 格式无效")}};c.useEffect(()=>{s==="code"&&(m(ye()),we(u))},[s]),c.useEffect(()=>{s==="code"&&we(u)},[u]);const Ne=()=>{j.trim()&&!A.includes(j.trim())&&(I([...A,j.trim()]),q(""))},Ye=n=>{I(A.filter(i=>i!==n))},ke=()=>{k.trim()&&!v.includes(k.trim())&&(C([...v,k.trim()]),h(""))},Ge=n=>{C(v.filter(i=>i!==n))},We=()=>{T(n=>({...n,headers:[...n.headers,{key:"",value:""}]}))},Ce=(n,i,l)=>{T(b=>({...b,headers:b.headers.map((O,H)=>H===n?{...O,[i]:l}:O)}))},_e=n=>{T(i=>({...i,headers:i.headers.filter((l,b)=>b!==n)}))},Ke=()=>{L([...P,{type:"word",condition:"or",values:[""],part:"body",negative:!1}])},me=(n,i)=>{L(P.map((l,b)=>b===n?{...l,...i}:l))},Ze=n=>{L(P.filter((i,l)=>l!==n))},Je=n=>{L(P.map((i,l)=>l===n?{...i,values:[...i.values,""]}:i))},Xe=(n,i,l)=>{L(P.map((b,O)=>O===n?{...b,values:b.values.map((H,K)=>K===i?l:H)}:b))},Qe=(n,i)=>{L(P.map((l,b)=>b===n?{...l,values:l.values.filter((O,H)=>H!==i)}:l))},et=async()=>{var i,l,b,O,H,K;const n=s==="visual"?ye():u;F(!0);try{const V={id:(e==null?void 0:e.id)||g,name:N,author:R,severity:G,description:W,reference:v,tags:A,category:ee,content:n,filePath:(e==null?void 0:e.filePath)||"",createdAt:(e==null?void 0:e.createdAt)||new Date().toISOString(),updatedAt:new Date().toISOString()};e!=null&&e.id?(b=(l=(i=window.go)==null?void 0:i.main)==null?void 0:l.App)!=null&&b.UpdatePOC&&await window.go.main.App.UpdatePOC(V):(K=(H=(O=window.go)==null?void 0:O.main)==null?void 0:H.App)!=null&&K.ImportPOC&&await window.go.main.App.ImportPOC(n),Oe.success("保存成功"),a()}catch(V){Oe.error("保存失败: "+((V==null?void 0:V.message)||"未知错误"))}finally{F(!1)}},_=({title:n,icon:i,section:l})=>t.jsxs("button",{onClick:()=>B(l),className:"w-full flex items-center justify-between p-4 hover:bg-dark-700/30 transition-colors",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(i,{className:"w-5 h-5 text-cyber-400"}),t.jsx("h2",{className:"text-lg font-semibold text-white",children:n})]}),M[l]?t.jsx(ut,{className:"w-5 h-5 text-dark-400"}):t.jsx(dt,{className:"w-5 h-5 text-dark-400"})]});return t.jsxs("div",{className:"h-full flex flex-col p-8",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("button",{onClick:r,className:`p-2 rounded-lg hover:bg-dark-700 text-dark-400 
                     hover:text-white transition-colors`,children:t.jsx(xe,{className:"w-5 h-5"})}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 rounded-lg bg-cyber-500/20 flex items-center justify-center",children:t.jsx(tt,{className:"w-5 h-5 text-cyber-400"})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-xl font-display font-bold text-white",children:e?"编辑 POC 模板":"新建 POC 模板"}),t.jsx("p",{className:"text-sm text-dark-400",children:g})]})]})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("div",{className:"flex items-center bg-dark-800 rounded-lg p-1",children:[t.jsxs("button",{onClick:()=>o("visual"),className:`flex items-center gap-2 px-3 py-1.5 rounded-md text-sm transition-colors
                        ${s==="visual"?"bg-cyber-500/20 text-cyber-400":"text-dark-400 hover:text-dark-200"}`,children:[t.jsx(Se,{className:"w-4 h-4"}),"可视化"]}),t.jsxs("button",{onClick:()=>o("code"),className:`flex items-center gap-2 px-3 py-1.5 rounded-md text-sm transition-colors
                        ${s==="code"?"bg-cyber-500/20 text-cyber-400":"text-dark-400 hover:text-dark-200"}`,children:[t.jsx(ht,{className:"w-4 h-4"}),"代码"]})]}),s==="code"&&t.jsxs("div",{className:`flex items-center gap-2 px-3 py-1.5 rounded-lg text-sm
                            ${U?"bg-green-500/10 text-green-400 border border-green-500/20":"bg-red-500/10 text-red-400 border border-red-500/20"}`,children:[U?t.jsx(nt,{className:"w-4 h-4"}):t.jsx(ft,{className:"w-4 h-4"}),t.jsx("span",{className:"max-w-xs truncate",children:f})]}),t.jsxs("button",{onClick:et,disabled:E||s==="code"&&!U,className:"btn btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:[t.jsx(at,{className:"w-4 h-4"}),E?"保存中...":"保存"]})]})]}),s==="visual"?t.jsxs("div",{className:"flex-1 overflow-y-auto space-y-4",children:[t.jsxs("div",{className:"card overflow-hidden",children:[t.jsx(_,{title:"基本信息",icon:Pe,section:"basic"}),M.basic&&t.jsxs("div",{className:"p-4 pt-0 grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-dark-400 mb-1",children:"POC ID *"}),t.jsx("input",{type:"text",value:g,onChange:n=>w(n.target.value.replace(/\s/g,"-").toLowerCase()),placeholder:"例如: CVE-2024-1234",className:"w-full font-mono"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-dark-400 mb-1",children:"名称 *"}),t.jsx("input",{type:"text",value:N,onChange:n=>D(n.target.value),placeholder:"漏洞名称",className:"w-full"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm text-dark-400 mb-1",children:[t.jsx(st,{className:"w-3 h-3 inline mr-1"}),"作者"]}),t.jsx("input",{type:"text",value:R,onChange:n=>J(n.target.value),placeholder:"你的名字",className:"w-full"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-dark-400 mb-1",children:"分类"}),t.jsx("input",{type:"text",value:ee,onChange:n=>S(n.target.value),placeholder:"例如: cves, vulnerabilities",className:"w-full"})]})]})]}),t.jsxs("div",{className:"card overflow-hidden",children:[t.jsx(_,{title:"严重程度",icon:ot,section:"severity"}),M.severity&&t.jsx("div",{className:"p-4 pt-0 flex gap-3",children:kr.map(n=>t.jsx("button",{onClick:()=>X(n.value),className:`px-4 py-2 rounded-lg border transition-all
                              ${G===n.value?`${n.color} border-current`:"text-dark-400 border-dark-600 hover:border-dark-500"}`,children:n.label},n.value))})]}),t.jsxs("div",{className:"card overflow-hidden",children:[t.jsx(_,{title:"漏洞描述",icon:Se,section:"description"}),M.description&&t.jsx("div",{className:"p-4 pt-0",children:t.jsx("textarea",{value:W,onChange:n=>Q(n.target.value),placeholder:"详细描述这个漏洞...",rows:3,className:"w-full resize-none"})})]}),t.jsxs("div",{className:"card overflow-hidden",children:[t.jsx(_,{title:"HTTP 请求 (Payload)",icon:rt,section:"http"}),M.http&&t.jsxs("div",{className:"p-4 pt-0 space-y-4",children:[t.jsx("div",{className:"flex items-center gap-4",children:t.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:y.useRaw,onChange:n=>T(i=>({...i,useRaw:n.target.checked})),className:"w-4 h-4 rounded border-dark-600 bg-dark-700 text-cyber-500"}),t.jsx("span",{className:"text-dark-300",children:"使用 Raw 请求"})]})}),y.useRaw?t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-dark-400 mb-1",children:"Raw HTTP 请求"}),t.jsx("textarea",{value:y.rawRequest,onChange:n=>T(i=>({...i,rawRequest:n.target.value})),placeholder:`GET {{BaseURL}}/admin HTTP/1.1
Host: {{Hostname}}
User-Agent: Mozilla/5.0

`,rows:8,className:"w-full font-mono text-sm resize-none"})]}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-dark-400 mb-1",children:"方法"}),t.jsx("select",{value:y.method,onChange:n=>T(i=>({...i,method:n.target.value})),className:"w-full",children:Cr.map(n=>t.jsx("option",{value:n,children:n},n))})]}),t.jsxs("div",{className:"col-span-3",children:[t.jsx("label",{className:"block text-sm text-dark-400 mb-1",children:"路径"}),t.jsx("input",{type:"text",value:y.path,onChange:n=>T(i=>({...i,path:n.target.value})),placeholder:"{{BaseURL}}/api/vulnerable",className:"w-full font-mono"})]})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("label",{className:"text-sm text-dark-400",children:"请求头"}),t.jsxs("button",{onClick:We,className:"text-cyber-400 hover:text-cyber-300 text-sm",children:[t.jsx(ne,{className:"w-4 h-4 inline mr-1"}),"添加"]})]}),y.headers.map((n,i)=>t.jsxs("div",{className:"flex gap-2 mb-2",children:[t.jsx("input",{type:"text",value:n.key,onChange:l=>Ce(i,"key",l.target.value),placeholder:"Header 名称",className:"w-1/3"}),t.jsx("input",{type:"text",value:n.value,onChange:l=>Ce(i,"value",l.target.value),placeholder:"Header 值",className:"flex-1"}),t.jsx("button",{onClick:()=>_e(i),className:"p-2 text-dark-400 hover:text-red-400",children:t.jsx(ge,{className:"w-4 h-4"})})]},i))]}),["POST","PUT","PATCH"].includes(y.method)&&t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-dark-400 mb-1",children:"请求体"}),t.jsx("textarea",{value:y.body,onChange:n=>T(i=>({...i,body:n.target.value})),placeholder:'{"username":"admin","password":"{{payload}}"}',rows:4,className:"w-full font-mono text-sm resize-none"})]})]})]})]}),t.jsxs("div",{className:"card overflow-hidden",children:[t.jsx(_,{title:"匹配规则 (Matchers)",icon:ct,section:"matchers"}),M.matchers&&t.jsxs("div",{className:"p-4 pt-0 space-y-4",children:[P.length>1&&t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("span",{className:"text-dark-400 text-sm",children:"匹配条件:"}),t.jsxs("select",{value:d,onChange:n=>p(n.target.value),className:"w-32",children:[t.jsx("option",{value:"and",children:"全部匹配 (AND)"}),t.jsx("option",{value:"or",children:"任意匹配 (OR)"})]})]}),P.map((n,i)=>t.jsxs("div",{className:"p-4 rounded-lg bg-dark-800/50 border border-dark-700/50 space-y-3",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("span",{className:"text-dark-300 font-medium",children:["匹配器 #",i+1]}),t.jsx("button",{onClick:()=>Ze(i),className:"text-dark-400 hover:text-red-400",children:t.jsx(ge,{className:"w-4 h-4"})})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs text-dark-500 mb-1",children:"类型"}),t.jsx("select",{value:n.type,onChange:l=>me(i,{type:l.target.value}),className:"w-full",children:Mr.map(l=>t.jsx("option",{value:l,children:l},l))})]}),n.type!=="status"&&t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs text-dark-500 mb-1",children:"匹配部分"}),t.jsx("select",{value:n.part,onChange:l=>me(i,{part:l.target.value}),className:"w-full",children:Or.map(l=>t.jsx("option",{value:l,children:l},l))})]}),t.jsx("div",{className:"flex items-end",children:t.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:n.negative,onChange:l=>me(i,{negative:l.target.checked}),className:"w-4 h-4 rounded border-dark-600 bg-dark-700 text-cyber-500"}),t.jsx("span",{className:"text-dark-300 text-sm",children:"反向匹配"})]})})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-1",children:[t.jsx("label",{className:"text-xs text-dark-500",children:n.type==="status"?"状态码":n.type==="word"?"关键词":"表达式"}),t.jsxs("button",{onClick:()=>Je(i),className:"text-cyber-400 hover:text-cyber-300 text-xs",children:[t.jsx(ne,{className:"w-3 h-3 inline mr-1"}),"添加"]})]}),n.values.map((l,b)=>t.jsxs("div",{className:"flex gap-2 mb-2",children:[t.jsx("input",{type:n.type==="status"?"number":"text",value:l,onChange:O=>Xe(i,b,O.target.value),placeholder:n.type==="status"?"200":n.type==="word"?"admin":n.type==="regex"?".*admin.*":'contains(body, "error")',className:"flex-1 font-mono text-sm"}),n.values.length>1&&t.jsx("button",{onClick:()=>Qe(i,b),className:"p-2 text-dark-400 hover:text-red-400",children:t.jsx(xe,{className:"w-4 h-4"})})]},b))]})]},i)),t.jsxs("button",{onClick:Ke,className:"btn btn-secondary w-full",children:[t.jsx(ne,{className:"w-4 h-4"}),"添加匹配器"]})]})]}),t.jsxs("div",{className:"card overflow-hidden",children:[t.jsx(_,{title:"标签",icon:it,section:"tags"}),M.tags&&t.jsxs("div",{className:"p-4 pt-0",children:[t.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:A.map(n=>t.jsxs("span",{className:"flex items-center gap-1 px-3 py-1 rounded-full bg-cyber-500/20 text-cyber-400 text-sm",children:[n,t.jsx("button",{onClick:()=>Ye(n),className:"hover:text-red-400",children:t.jsx(xe,{className:"w-3 h-3"})})]},n))}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("input",{type:"text",value:j,onChange:n=>q(n.target.value),onKeyDown:n=>n.key==="Enter"&&Ne(),placeholder:"添加标签...",className:"flex-1"}),t.jsx("button",{onClick:Ne,className:"btn btn-secondary",children:t.jsx(ne,{className:"w-4 h-4"})})]})]})]}),t.jsxs("div",{className:"card overflow-hidden",children:[t.jsx(_,{title:"参考链接",icon:mt,section:"references"}),M.references&&t.jsxs("div",{className:"p-4 pt-0",children:[t.jsx("div",{className:"space-y-2 mb-3",children:v.map((n,i)=>t.jsxs("div",{className:"flex items-center gap-2 p-2 rounded-lg bg-dark-800/50",children:[t.jsx(lt,{className:"w-4 h-4 text-dark-500 flex-shrink-0"}),t.jsx("span",{className:"flex-1 text-sm text-cyber-400 truncate",children:n}),t.jsx("button",{onClick:()=>Ge(n),className:"p-1 hover:text-red-400",children:t.jsx(ge,{className:"w-4 h-4"})})]},i))}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("input",{type:"url",value:k,onChange:n=>h(n.target.value),onKeyDown:n=>n.key==="Enter"&&ke(),placeholder:"https://...",className:"flex-1"}),t.jsx("button",{onClick:ke,className:"btn btn-secondary",children:t.jsx(ne,{className:"w-4 h-4"})})]})]})]})]}):t.jsxs("div",{className:"flex-1 flex flex-col",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-3 text-dark-500 text-sm",children:[t.jsx(Pe,{className:"w-4 h-4"}),t.jsx("span",{children:"使用标准 Nuclei YAML 格式编写模板"})]}),t.jsx("div",{className:"flex-1 card overflow-hidden monaco-container",children:t.jsx(Nr,{height:"100%",defaultLanguage:"yaml",value:u,onChange:n=>m(n||""),theme:"vs-dark",options:{fontSize:14,fontFamily:"JetBrains Mono, Fira Code, monospace",minimap:{enabled:!0},scrollBeyondLastLine:!1,automaticLayout:!0,tabSize:2,wordWrap:"on",lineNumbers:"on",renderLineHighlight:"all",cursorBlinking:"smooth",smoothScrolling:!0,padding:{top:16,bottom:16}}})}),t.jsxs("div",{className:"mt-4 p-4 rounded-lg bg-dark-800/50 border border-dark-700/50",children:[t.jsx("h3",{className:"text-sm font-medium text-dark-300 mb-2",children:"快速参考"}),t.jsxs("div",{className:"grid grid-cols-4 gap-4 text-xs text-dark-500",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-dark-400",children:"变量:"}),t.jsx("br",{}),"{{BaseURL}}, {{Hostname}}, {{Host}}"]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-dark-400",children:"HTTP 方法:"}),t.jsx("br",{}),"GET, POST, PUT, DELETE"]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-dark-400",children:"匹配类型:"}),t.jsx("br",{}),"status, word, regex, dsl"]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-dark-400",children:"协议:"}),t.jsx("br",{}),"http, dns, tcp, ssl"]})]})]})]})]})}export{Ur as default};
